subject: Pike 7.8: Stdio.sendfile, Updated tzdata, pgsql, dwim_time, SSL fix for poodle attack
from: 0cdab7d984919dde228cf17b25b6398633a73551
to: 6bf2251fdc7669fd61cd20227537391b443200c6
originator: wellhardh@roxen.com
depends: 2014-06-17T093911
restart: true

Multiple fixes:

  * Stdio.sendfile: Fixed use before set.
    
    Fixes "Indexing the NULL value with \"call_out\".", when
    Stdio.sendfile(({""}), 0, -1, -1, 0, simulated_file, cb, ...).
    
    Also fixes issue where the trailers weren't sent if there was no
    source file, no headers and a non-empty file length.
    
    Fixes [bug 7230].

  * Updated to tzdata2014f.
    
    Also removed some obsolete files (solar8[789]) and added zone1970.tab.
    
    Also adds some further files.
    
    The tzdata directory should now be fully in sync with the tzdata2014f dist.

  * PGSQL: Database creation doesn't work with bound parameters.

  * Revert "dwim_time() should know how to parse ISO 8601 timestamps."
    
    This patch had the opposite effect of the intended...
    
    This reverts commit 962105c4c0eaa08aaba357343845b3046b6741b9.

  * Search.Database.MySQL: Don't used DELAYED queries.
    
    The DELAYED query modifier is:
    
      * Not supported with InnoDB tables. This causes failures with
        MySQL versions (eg 5.5) where InnoDB (and not MyISAM) is default.
    
      * Ignored in MySQL 5.6.
    
      * Deprecated in MySQL 5.6.6.
    
    Fixes [bug 7255].

  * Updated to tzdata2014g.

  * SSL: Added server-side support for TLS_fallback_scsv.
    
    This implements some protection against TLS 1.0 ==> SSL 3.0
    downgrade attacks. cf "This POODLE Bites: Exploiting The
    SSL 3.0 Fallback": https://www.openssl.org/~bodo/ssl-poodle.pdf

  * SSL: Support TLS_fallback_scsv in SSLv2 handshake too.
